<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: openLotsScript.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: openLotsScript.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';
const webfw = require('eze-e2e-webframework');
const trading = require('eze-e2e-trading');
const moment = require('moment');
var openLotsPage = require('../pageObjects/openLotsPage');
var controls = require('../pageObjects/Controls/reportControls');
var logger = new webfw.log('Reports Script');
var accountingUtils = require('../utils');
var shell = require('./accountingShell');
const integration = require("eze-integration-protractor-framework");

/**
 * APIs for interacting with Open Lots report
 */
class OpenLotsReport {
    /**
     * Select an order on the blotter to check its Trade Date and run an Open Lots report for that Date.
     *
     * Selects Open Lots report from the dropdown.
     * @param {String} symbol of the order on the blotter that will be selected
     * @param {String} status of the order
     * @param {Int} quantity or the amount of the order
     * @param {string} side or action of the order you would like to select
     * @param {string} logicalTimeValue value for logical Time field.
     * @param {string} stateValue order state for the report.
     * @param {string}  viewConfigurationValue  of the report.
     */
     static runOpenLotsReportForOrderDate(symbol, status, quantity, side, logicalTimeValue, stateValue, viewConfigurationValue) {
          trading.shell.navigateToBlotter();
          trading.orders.getColumnValueForOrder('TradeDate', symbol, status, quantity, side).then((value) => {
            var date = new Date(value)
            var businessDate = moment(date).format('MM/DD/YYYY');
            return this.runOpenLotsReportSpecifyDate(businessDate, logicalTimeValue, stateValue, viewConfigurationValue);
          });
     }

     /**
      * Run an Open Lots accounting report for a specific Date, Logical Time , State, and View Configuration.
      *
      * Selects Open Lots report from the dropdown.
      * @param {string} dateValue format as a string 'mm/dd/yyyy'
      * @param {string} logicalTimeValue value for logical Time field.
      * @param {string} stateValue state of a report.
      * @param {string}  viewConfigurationValue  of a report.
      */
      static runOpenLotsReportSpecifyDate(businessDateValue, logicalTimeValue, stateValue, viewConfigurationValue) {
          shell.navigateToReports();
          controls.getReportPageStatus().then((pageStatus) => {
              openLotsPage.selectOpenLotsReport(pageStatus);
              return openLotsPage.setBusinessDate(pageStatus, businessDateValue).then(() => {
                  openLotsPage.verifyBusinessDate(pageStatus, businessDateValue);
                  return openLotsPage.setLogicalTime(pageStatus, logicalTimeValue).then(() => {
                      console.log('set logical time')
                      openLotsPage.verifyLogicalTime(pageStatus, logicalTimeValue);
                      return openLotsPage.setState(pageStatus, stateValue).then(() => {
                          console.log('set position state')
                          openLotsPage.verifyState(pageStatus, stateValue);
                          return openLotsPage.setViewConfiguration(pageStatus, viewConfigurationValue).then(() => {
                              openLotsPage.verifyViewConfiguration(pageStatus, viewConfigurationValue);
                              console.log('report settings changed');
                              return controls.clickApply(pageStatus).then(() => {
                                   console.log('Clicked Apply button to run the report');
                                   console.log('Waiting for report to load');
                                   return webfw.utils.waitForElementNotPresent(controls.elements.reportContentBusyIndicator, 'Busy Indicator').then(() => {
                                      console.log('Report loaded');
                                  });
                              });
                          });
                      });
                  });
              });
          });
      }

    /**
     * Change Date for Business Date field. Use this function to change only business date.
     *
     * @param {dateFormat} dateValue is a date
     * 
     */
    static changeBusinessDate(dateValue) {
        shell.navigateToReports();
        controls.getReportPageStatus().then((pageStatus) => {
          openLotsPage.setBusinessDate(pageStatus, dateValue);
          openLotsPage.verifyBusinessDate(pageStatus, dateValue)
          logger.debug('clicking on Apply button');
          controls.clickApply(pageStatus);
          webfw.utils.waitForElementNotPresent(controls.elements.reportContentBusyIndicator, 'Busy Indicator');
        });
    }

    /**
     * Change logical Time of a report.
     * @param {string} logicalTimeValue value for logical Time field.
     * 
     */
    static changeLogicalTime(logicalTimeValue) {
        shell.navigateToReports();
        controls.getReportPageStatus().then((pageStatus) => {
          openLotsPage.setLogicalTime(pageStatus, logicalTimeValue);
          openLotsPage.verifyLogicalTime(pageStatus, logicalTimeValue);
          logger.debug('clicking on Apply button');
          controls.clickApply();
          webfw.utils.waitForElementNotPresent(controls.elements.reportContentBusyIndicator, 'Busy Indicator');
        });
    }

    /**
     * Change State of a report.
     * @param {string} stateValue state of a report.
     * 
     */
    static changeState(stateValue) {
        shell.navigateToReports();
        controls.getReportPageStatus().then((pageStatus) => {
          openLotsPage.setState(pageStatus, stateValue);
          openLotsPage.verifyState(pageStatus, stateValue);
          logger.debug('clicking on Apply button');
          controls.clickApply();
          webfw.utils.waitForElementNotPresent(controls.elements.reportContentBusyIndicator, 'Busy Indicator');
        });
    }

    /**
     * Change View Configuration  of a report.
     * @param {string}  viewConfigurationValue  of a report.
     * 
     */
    static changeViewConfiguration(viewConfigurationValue) {
        shell.navigateToReports();
        controls.getReportPageStatus().then((pageStatus) => {
          openLotsPage.setViewConfiguration(pageStatus, viewConfigurationValue);
          openLotsPage.verifyViewConfiguration(pageStatus, viewConfigurationValue);
          logger.debug('clicking on Apply button');
          controls.clickApply();
          webfw.utils.waitForElementNotPresent(controls.elements.reportContentBusyIndicator, 'Busy Indicator');
        });
    }

    /**
     * verify the value of quantity column.
     * @param {string}  cellValue  of quantity that you would like to varify.
	 * 
     */
    static verifyLotQuantity(cellValue) {
        shell.navigateToReports();
        var resultValue = controls.getTextQuantity(controls.elements.tradeQuantityCell);
        expect(resultValue).toBe(cellValue.toString());
        logger.debug('Get value is ' + resultValue + ', which should be equal to '+ cellValue);
    }
    /**
     * select a row.
     * @param {string}  value  of quantity that you would like to varify.
	 * 
     */
    static selectOpenLotsRow(symbol, tradeQuantity) {
        shell.navigateToReports();
        return  openLotsPage.openLotsRow(symbol, tradeQuantity);
    }

}
module.exports = OpenLotsReport;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="NAVandPLReport.html">NAVandPLReport</a></li><li><a href="OpenLotsReport.html">OpenLotsReport</a></li><li><a href="PositionValReport.html">PositionValReport</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.1</a> on Thu Jul 13 2017 14:43:50 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
